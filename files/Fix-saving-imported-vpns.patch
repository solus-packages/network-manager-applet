From 9b5c5eed6aa68eae373d948375adbbc3fabcea27 Mon Sep 17 00:00:00 2001
From: Thomas Haller <thaller@redhat.com>
Date: Thu, 13 Sep 2018 21:28:36 +0200
Subject: [PATCH 1/3] Revert "8021x-security: don't show_all() the widgets"

This reverts commit 546539e3c9fe40ab71ed3d62312e9768df661371.
---
 src/connection-editor/page-8021x-security.c | 1 +
 1 file changed, 1 insertion(+)

diff --git a/src/connection-editor/page-8021x-security.c b/src/connection-editor/page-8021x-security.c
index 874384ae..bbe614bb 100644
--- a/src/connection-editor/page-8021x-security.c
+++ b/src/connection-editor/page-8021x-security.c
@@ -88,6 +88,7 @@ finish_setup (CEPage8021xSecurity *self, gpointer user_data)
 
 	gtk_box_pack_start (GTK_BOX (parent->page), GTK_WIDGET (priv->enabled), FALSE, TRUE, 12);
 	gtk_box_pack_start (GTK_BOX (parent->page), priv->security_widget, TRUE, TRUE, 0);
+	gtk_widget_show_all (parent->page);
 }
 
 CEPage *
-- 
2.18.0


From 2f6caff910304a58168961e1d2aa5259a9bf5e0f Mon Sep 17 00:00:00 2001
From: Thomas Haller <thaller@redhat.com>
Date: Thu, 13 Sep 2018 21:28:38 +0200
Subject: [PATCH 2/3] Revert "editor/vpn: don't show_all() the widgets"

This reverts commit ba8df364841f9435579b5234e11ebf68bdc14c53.
---
 src/connection-editor/page-vpn.c | 1 +
 1 file changed, 1 insertion(+)

diff --git a/src/connection-editor/page-vpn.c b/src/connection-editor/page-vpn.c
index 667340d1..da99f7b3 100644
--- a/src/connection-editor/page-vpn.c
+++ b/src/connection-editor/page-vpn.c
@@ -75,6 +75,7 @@ finish_setup (CEPageVpn *self, gpointer user_data)
 		return;
 	}
 	g_object_ref_sink (parent->page);
+	gtk_widget_show_all (parent->page);
 }
 
 CEPage *
-- 
2.18.0


From f56334c307f22255d0e01fa3e003ddb49f287e2c Mon Sep 17 00:00:00 2001
From: Thomas Haller <thaller@redhat.com>
Date: Thu, 13 Sep 2018 21:28:40 +0200
Subject: [PATCH 3/3] Revert "libnma: drop use of GtkWidget.no-show-all
 property"

This reverts commit 07d900c0b3a52ee7aefc2f24e62914d40113b24b.
---
 src/libnma/nma-file-cert-chooser.c    |  7 +++++++
 src/libnma/nma-mobile-wizard.ui       |  2 +-
 src/libnma/nma-vpn-password-dialog.ui | 18 +++++++++++-------
 3 files changed, 19 insertions(+), 8 deletions(-)

diff --git a/src/libnma/nma-file-cert-chooser.c b/src/libnma/nma-file-cert-chooser.c
index e263bb9a..ad239af4 100644
--- a/src/libnma/nma-file-cert-chooser.c
+++ b/src/libnma/nma-file-cert-chooser.c
@@ -307,6 +307,7 @@ init (NMACertChooser *cert_chooser)
 	gtk_widget_set_hexpand (priv->key_button, TRUE);
 	gtk_widget_set_sensitive (priv->key_button, FALSE);
 	gtk_widget_show (priv->key_button);
+	gtk_widget_set_no_show_all (priv->key_button, TRUE);
 
 	g_signal_connect (priv->key_button, "selection-changed",
 	                  G_CALLBACK (key_changed_cb), cert_chooser);
@@ -317,6 +318,7 @@ init (NMACertChooser *cert_chooser)
 	gtk_grid_attach (GTK_GRID (cert_chooser), priv->key_button_label, 0, 0, 1, 1);
 	gtk_widget_set_sensitive (priv->key_button_label, FALSE);
 	gtk_widget_show (priv->key_button_label);
+	gtk_widget_set_no_show_all (priv->key_button_label, TRUE);
 
 	/* The key password entry */
 	gtk_grid_insert_row (GTK_GRID (cert_chooser), 1);
@@ -327,6 +329,7 @@ init (NMACertChooser *cert_chooser)
 	gtk_widget_set_hexpand (priv->key_password, TRUE);
 	gtk_widget_set_sensitive (priv->key_password, FALSE);
 	gtk_widget_show (priv->key_password);
+	gtk_widget_set_no_show_all (priv->key_password, TRUE);
 
 	g_signal_connect (priv->key_password, "changed",
 	                  G_CALLBACK (key_password_changed_cb), cert_chooser);
@@ -337,12 +340,14 @@ init (NMACertChooser *cert_chooser)
 	gtk_grid_attach (GTK_GRID (cert_chooser), priv->key_password_label, 0, 1, 1, 1);
 	gtk_widget_set_sensitive (priv->key_password_label, FALSE);
 	gtk_widget_show (priv->key_password_label);
+	gtk_widget_set_no_show_all (priv->key_password_label, TRUE);
 
 	/* Show password */
 	gtk_grid_insert_row (GTK_GRID (cert_chooser), 2);
 	priv->show_password = gtk_check_button_new_with_mnemonic ("Sho_w password");
 	gtk_grid_attach (GTK_GRID (cert_chooser), priv->show_password, 1, 2, 1, 1);
 	gtk_widget_show (priv->show_password);
+	gtk_widget_set_no_show_all (priv->show_password, TRUE);
 	g_signal_connect (priv->show_password, "toggled",
 	                  G_CALLBACK (show_toggled_cb), cert_chooser);
 
@@ -358,6 +363,7 @@ init (NMACertChooser *cert_chooser)
 	gtk_grid_attach (GTK_GRID (cert_chooser), priv->cert_button, 1, 0, 1, 1);
 	gtk_widget_set_hexpand (priv->cert_button, TRUE);
 	gtk_widget_show (priv->cert_button);
+	gtk_widget_set_no_show_all (priv->cert_button, TRUE);
 
 	/* For some reason, GTK+ calls set_current_filter (..., NULL) from
 	 * gtkfilechooserdefault.c::show_and_select_files_finished_loading() on our
@@ -375,6 +381,7 @@ init (NMACertChooser *cert_chooser)
 	gtk_label_set_mnemonic_widget (GTK_LABEL (priv->cert_button_label), priv->cert_button);
 	gtk_grid_attach (GTK_GRID (cert_chooser), priv->cert_button_label, 0, 0, 1, 1);
 	gtk_widget_show (priv->cert_button_label);
+	gtk_widget_set_no_show_all (priv->cert_button_label, TRUE);
 }
 
 const NMACertChooserVtable nma_cert_chooser_vtable_file = {
diff --git a/src/libnma/nma-mobile-wizard.ui b/src/libnma/nma-mobile-wizard.ui
index 07b31fe9..6cef85f7 100644
--- a/src/libnma/nma-mobile-wizard.ui
+++ b/src/libnma/nma-mobile-wizard.ui
@@ -608,9 +608,9 @@ If you are unsure of your plan please ask your provider for your plan’s APN.</
         </child>
         <child>
           <object class="GtkLabel" id="confirm_connect_after_label">
-            <property name="visible">False</property>
             <property name="width_request">500</property>
             <property name="can_focus">False</property>
+            <property name="no_show_all">True</property>
             <property name="valign">end</property>
             <property name="vexpand">True</property>
             <property name="label" translatable="yes">A connection will now be made to your mobile broadband provider using the settings you selected. If the connection fails or you cannot access network resources, double-check your settings. To modify your mobile broadband connection settings, choose “Network Connections” from the System → Preferences menu.</property>
diff --git a/src/libnma/nma-vpn-password-dialog.ui b/src/libnma/nma-vpn-password-dialog.ui
index b611bec2..bcbac83c 100644
--- a/src/libnma/nma-vpn-password-dialog.ui
+++ b/src/libnma/nma-vpn-password-dialog.ui
@@ -86,8 +86,8 @@
             </child>
             <child>
               <object class="GtkEntry" id="password_entry_tertiary">
-                <property name="visible">False</property>
                 <property name="can_focus">True</property>
+                <property name="no_show_all">True</property>
                 <property name="visibility">False</property>
                 <property name="width_chars">20</property>
                 <signal name="activate" handler="gtk_window_activate_default" swapped="yes"/>
@@ -99,8 +99,9 @@
             </child>
             <child>
               <object class="GtkEntry" id="password_entry_secondary">
-                <property name="visible">False</property>
+                <property name="visible">True</property>
                 <property name="can_focus">True</property>
+                <property name="no_show_all">True</property>
                 <property name="visibility">False</property>
                 <property name="width_chars">20</property>
                 <signal name="activate" handler="gtk_window_activate_default" swapped="yes"/>
@@ -112,8 +113,9 @@
             </child>
             <child>
               <object class="GtkEntry" id="password_entry">
-                <property name="visible">False</property>
+                <property name="visible">True</property>
                 <property name="can_focus">True</property>
+                <property name="no_show_all">True</property>
                 <property name="visibility">False</property>
                 <property name="width_chars">20</property>
                 <signal name="activate" handler="gtk_window_activate_default" swapped="yes"/>
@@ -125,8 +127,8 @@
             </child>
             <child>
               <object class="GtkLabel" id="password_label_tertiary">
-                <property name="visible">False</property>
                 <property name="can_focus">False</property>
+                <property name="no_show_all">True</property>
                 <property name="label" translatable="yes">_Tertiary Password:</property>
                 <property name="use_underline">True</property>
                 <property name="mnemonic_widget">password_entry_tertiary</property>
@@ -139,8 +141,9 @@
             </child>
             <child>
               <object class="GtkLabel" id="password_label_secondary">
-                <property name="visible">False</property>
+                <property name="visible">True</property>
                 <property name="can_focus">False</property>
+                <property name="no_show_all">True</property>
                 <property name="label" translatable="yes">_Secondary Password:</property>
                 <property name="use_underline">True</property>
                 <property name="mnemonic_widget">password_entry_secondary</property>
@@ -153,8 +156,9 @@
             </child>
             <child>
               <object class="GtkLabel" id="password_label">
-                <property name="visible">False</property>
+                <property name="visible">True</property>
                 <property name="can_focus">False</property>
+                <property name="no_show_all">True</property>
                 <property name="label" translatable="yes">_Password:</property>
                 <property name="use_underline">True</property>
                 <property name="mnemonic_widget">password_entry</property>
@@ -167,8 +171,8 @@
             </child>
             <child>
               <object class="GtkLabel" id="message_label">
-                <property name="visible">False</property>
                 <property name="can_focus">False</property>
+                <property name="no_show_all">True</property>
                 <property name="halign">start</property>
                 <property name="margin_bottom">12</property>
                 <property name="hexpand">True</property>
-- 
2.18.0

